---
driver:
  name: docker
lint:
  name: yamllint
platforms:
  - name: ubuntuapp
    image: s3than/systemd-ubuntu:latest
    command: /sbin/init
    capabilities:
      - SYS_ADMIN
    privileged: true
    volumes:
      - "/sys/fs/cgroup:/sys/fs/cgroup:ro"
      - "/var/run/docker.sock:/var/run/docker.sock"
    tmpfs:
      - /run
      - /run/lock
    security_opts:
      - "seccomp:unconfined"
provisioner:
  name: ansible
  inventory:
    group_vars:
      all:
        docker_iam: true
        docker_storage_driver: 'vfs'
        docker_install_compose: false
  playbooks:
    create: ../resources/create.yml
    converge: ../resources/playbook.yml
    destroy: ../resources/destroy.yml
  lint:
    name: ansible-lint
scenario:
  name: iam-docker
  test_sequence:
    - lint
    - destroy
    - syntax
    - create
    - converge
    # Shell commands needed for determining if iam is running
    # - idempotence
    - verify
    - destroy
verifier:
  name: goss
  lint:
    name: flake8
